{
    "version": 3,
    "terraform_version": "0.9.11",
    "serial": 25,
    "lineage": "d7df41e4-53c7-46c1-8ffd-cf266a3c38d0",
    "modules": [
        {
            "path": [
                "root"
            ],
            "outputs": {
                "awsconfigchanges_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "awsconfigchanges"
                },
                "awsconfigchanges_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "awsconfigchanges"
                },
                "bucketpolicychanges_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "bucketpolicychanges"
                },
                "bucketpolicychanges_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "bucketpolicychanges"
                },
                "cloudtrailconfigchanges_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "cloudtrailconfigchanges"
                },
                "cloudtrailconfigchanges_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "cloudtrailconfigchanges"
                },
                "consolenomfa_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "consolenomfa"
                },
                "consolenomfa_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "consolenomfa"
                },
                "iampolicychanges_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "iampolicychanges"
                },
                "iampolicychanges_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "iampolicychanges"
                },
                "mgtconsolefailures_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "mgtconsolefailures"
                },
                "mgtconsolefailures_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "mgtconsolefailures"
                },
                "naclchanges_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "naclchanges"
                },
                "naclchanges_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "naclchanges"
                },
                "networkgatewaychanges_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "networkgatewaychanges"
                },
                "networkgatewaychanges_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "networkgatewaychanges"
                },
                "rootaccountusage_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "rootaccountusage"
                },
                "rootaccountusage_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "rootaccountusage"
                },
                "routetablechanges_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "routetablechanges"
                },
                "routetablechanges_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "routetablechanges"
                },
                "scheduledcmkdeletion_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "scheduledcmkdeletion"
                },
                "scheduledcmkdeletion_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "scheduledcmkdeletion"
                },
                "securitygroupchanges_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "securitygroupchanges"
                },
                "securitygroupchanges_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "securitygroupchanges"
                },
                "topic_arn": {
                    "sensitive": false,
                    "type": "string",
                    "value": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic"
                },
                "unuatorhized-api-calls_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "unuatorhized-api-calls"
                },
                "unuatorhized-api-calls_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "unuatorhized-api-calls"
                },
                "vpcchanges_alarm": {
                    "sensitive": false,
                    "type": "string",
                    "value": "vpcchanges"
                },
                "vpcchanges_filter": {
                    "sensitive": false,
                    "type": "string",
                    "value": "vpcchanges"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-1-unuatorhized-api-calls"
            ],
            "outputs": {},
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-10-securitygroupchanges"
            ],
            "outputs": {
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "securitygroupchanges"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-11-naclchanges"
            ],
            "outputs": {
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "naclchanges"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-12-networkgatewaychanges"
            ],
            "outputs": {
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "networkgatewaychanges"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-13-routetablechanges"
            ],
            "outputs": {
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "routetablechanges"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-2-consolenomfa"
            ],
            "outputs": {
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "consolenomfa"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-3-rootaccountusage"
            ],
            "outputs": {
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "rootaccountusage"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-4-iampolicychanges"
            ],
            "outputs": {
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "iampolicychanges"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-5-cloudtrailconfigchanges"
            ],
            "outputs": {
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "cloudtrailconfigchanges"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-6-mgtconsolefailures"
            ],
            "outputs": {
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "mgtconsolefailures"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-7-scheduledcmkdeletion"
            ],
            "outputs": {
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "scheduledcmkdeletion"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-8-bucketpolicychanges"
            ],
            "outputs": {
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "bucketpolicychanges"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "3-9-awsconfigchanges"
            ],
            "outputs": {
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "awsconfigchanges"
                }
            },
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "alert-topic"
            ],
            "outputs": {
                "topic_arn": {
                    "sensitive": false,
                    "type": "string",
                    "value": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic"
                }
            },
            "resources": {
                "aws_sns_topic.alert_topic": {
                    "type": "aws_sns_topic",
                    "depends_on": [],
                    "primary": {
                        "id": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                        "attributes": {
                            "arn": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "display_name": "",
                            "id": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "name": "cw-alert-topic",
                            "policy": "{\"Id\":\"__default_policy_ID\",\"Statement\":[{\"Action\":[\"SNS:GetTopicAttributes\",\"SNS:SetTopicAttributes\",\"SNS:AddPermission\",\"SNS:RemovePermission\",\"SNS:DeleteTopic\",\"SNS:Subscribe\",\"SNS:ListSubscriptionsByTopic\",\"SNS:Publish\",\"SNS:Receive\"],\"Condition\":{\"StringEquals\":{\"AWS:SourceOwner\":\"243740175260\"}},\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Resource\":\"arn:aws:sns:eu-west-1:243740175260:cw-alert-topic\",\"Sid\":\"__default_statement_ID\"}],\"Version\":\"2008-10-17\"}"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "awsconfigchanges"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "awsconfigchanges"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "awsconfigchanges"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "awsconfigchanges",
                        "attributes": {
                            "id": "awsconfigchanges",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "AWSConfigChanges",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "awsconfigchanges",
                            "pattern": "{($.eventSource = config.amazonaws.com) \u0026\u0026 (($.eventName=StopConfigurationRecorder)||($.eventName=DeleteDeliveryChannel)||($.eventName=PutDeliveryChannel)||($.eventName=PutConfigurationRecorder))}"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "awsconfigchanges",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors config changes",
                            "alarm_name": "awsconfigchanges",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "awsconfigchanges",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "AWSConfigChanges",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "bucketpolicychanges"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "bucketpolicychanges"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "bucketpolicychanges"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "bucketpolicychanges",
                        "attributes": {
                            "id": "bucketpolicychanges",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "BucketPolicyChanges",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "bucketpolicychanges",
                            "pattern": "{ ($.eventSource = s3.amazonaws.com) \u0026\u0026 (($.eventName = PutBucketAcl) || ($.eventName = PutBucketPolicy) || ($.eventName = PutBucketCors) || ($.eventName = PutBucketLifecycle) || ($.eventName = PutBucketReplication) || ($.eventName = DeleteBucketPolicy) || ($.eventName = DeleteBucketCors) || ($.eventName = DeleteBucketLifecycle) || ($.eventName = DeleteBucketReplication)) }"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "bucketpolicychanges",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors bucket policy changes",
                            "alarm_name": "bucketpolicychanges",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "bucketpolicychanges",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "BucketPolicyChanges",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "cloudtrailconfigchanges"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "cloudtrailconfigchanges"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "cloudtrailconfigchanges"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "cloudtrailconfigchanges",
                        "attributes": {
                            "id": "cloudtrailconfigchanges",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "CloudTrailChanges",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "cloudtrailconfigchanges",
                            "pattern": "{ ($.eventName = CreateTrail) || ($.eventName = UpdateTrail) || ($.eventName = DeleteTrail) || ($.eventName = StartLogging) || ($.eventName = StopLogging) }"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "cloudtrailconfigchanges",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors CloudTrail Changes",
                            "alarm_name": "cloudtrailconfigchanges",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "cloudtrailconfigchanges",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "CloudTrailChanges",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "cloudwatch-metrics-alarms"
            ],
            "outputs": {},
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "consolenomfa"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "consolenomfa"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "consolenomfa"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "consolenomfa",
                        "attributes": {
                            "id": "consolenomfa",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "ConsoleSignInWithoutMfaCount",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "consolenomfa",
                            "pattern": "{ ($.eventName = \"ConsoleLogin\") \u0026\u0026 ($.additionalEventData.MFAUsed != \"Yes\") }"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "consolenomfa",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors Console Logins without MFA",
                            "alarm_name": "consolenomfa",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "consolenomfa",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "ConsoleSignInWithoutMfaCount",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "iampolicychanges"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "iampolicychanges"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "iampolicychanges"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "iampolicychanges",
                        "attributes": {
                            "id": "iampolicychanges",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "IAMPolicyChanges",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "iampolicychanges",
                            "pattern": "{($.eventName=DeleteGroupPolicy)||($.eventName=DeleteRolePolicy)||($.eventName=DeleteUserPolicy)||($.eventName=PutGroupPolicy)||($.eventName=PutRolePolicy)||($.eventName=PutUserPolicy)||($.eventName=CreatePolicy)||($.eventName=DeletePolicy)||($.eventName=CreatePolicyVersion)||($.eventName=DeletePolicyVersion)||($.eventName=AttachRolePolicy)||($.eventName=DetachRolePolicy)||($.eventName=AttachUserPolicy)||($.eventName=DetachUserPolicy)||($.eventName=AttachGroupPolicy)||($.eventName=DetachGroupPolicy)}"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "iampolicychanges",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors IAM Policy Changes",
                            "alarm_name": "iampolicychanges",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "iampolicychanges",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "IAMPolicyChanges",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "mgtconsolefailures"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "mgtconsolefailures"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "mgtconsolefailures"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "mgtconsolefailures",
                        "attributes": {
                            "id": "mgtconsolefailures",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "ConsoleAuthenticationFailures",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "mgtconsolefailures",
                            "pattern": "{ ($.eventName = ConsoleLogin) \u0026\u0026 ($.errorMessage = \"Failed authentication\") }"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "mgtconsolefailures",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors Management Console Failures",
                            "alarm_name": "mgtconsolefailures",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "mgtconsolefailures",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "ConsoleAuthenticationFailures",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "naclchanges"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "naclchanges"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "naclchanges"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "naclchanges",
                        "attributes": {
                            "id": "naclchanges",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "NACLChanges",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "naclchanges",
                            "pattern": "{ ($.eventName = CreateNetworkAcl) || ($.eventName = CreateNetworkAclEntry) || ($.eventName = DeleteNetworkAcl) || ($.eventName = DeleteNetworkAclEntry) || ($.eventName = ReplaceNetworkAclEntry) || ($.eventName = ReplaceNetworkAclAssociation) }"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "naclchanges",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors nacl changes",
                            "alarm_name": "naclchanges",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "naclchanges",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "NACLChanges",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "networkgatewaychanges"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "networkgatewaychanges"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "networkgatewaychanges"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "networkgatewaychanges",
                        "attributes": {
                            "id": "networkgatewaychanges",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "NetworkGatewayChanges",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "networkgatewaychanges",
                            "pattern": "{ ($.eventName = CreateCustomerGateway) || ($.eventName = DeleteCustomerGateway) || ($.eventName = AttachInternetGateway) || ($.eventName = CreateInternetGateway) || ($.eventName = DeleteInternetGateway) || ($.eventName = DetachInternetGateway) }"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "networkgatewaychanges",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors network gateway changes",
                            "alarm_name": "networkgatewaychanges",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "networkgatewaychanges",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "NetworkGatewayChanges",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "rootaccountusage"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "rootaccountusage"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "rootaccountusage"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "rootaccountusage",
                        "attributes": {
                            "id": "rootaccountusage",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "RootAccountUsage",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "rootaccountusage",
                            "pattern": "{ $.userIdentity.type = \"Root\" \u0026\u0026 $.userIdentity.invokedBy NOT EXISTS \u0026\u0026 $.eventType != \"AwsServiceEvent\" }"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "rootaccountusage",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors Root Account usaged",
                            "alarm_name": "rootaccountusage",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "rootaccountusage",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "RootAccountUsage",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "routetablechanges"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "routetablechanges"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "routetablechanges"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "routetablechanges",
                        "attributes": {
                            "id": "routetablechanges",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "RouteTableChanges",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "routetablechanges",
                            "pattern": "{ ($.eventName = CreateRoute) || ($.eventName = CreateRouteTable) || ($.eventName = ReplaceRoute) || ($.eventName = ReplaceRouteTableAssociation) || ($.eventName = DeleteRouteTable) || ($.eventName = DeleteRoute) || ($.eventName = DisassociateRouteTable) }"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "routetablechanges",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors route table changes",
                            "alarm_name": "routetablechanges",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "routetablechanges",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "RouteTableChanges",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "scheduledcmkdeletion"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "scheduledcmkdeletion"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "scheduledcmkdeletion"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "scheduledcmkdeletion",
                        "attributes": {
                            "id": "scheduledcmkdeletion",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "ScheduledCMKDeletion",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "scheduledcmkdeletion",
                            "pattern": "{($.eventSource = kms.amazonaws.com) \u0026\u0026 (($.eventName=DisableKey)||($.eventName=ScheduleKeyDeletion))}"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "scheduledcmkdeletion",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors scheduled CMK deletion",
                            "alarm_name": "scheduledcmkdeletion",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "scheduledcmkdeletion",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "ScheduledCMKDeletion",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "securitygroupchanges"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "securitygroupchanges"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "securitygroupchanges"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "securitygroupchanges",
                        "attributes": {
                            "id": "securitygroupchanges",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "SecurityGroupChanges",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "securitygroupchanges",
                            "pattern": "{ ($.eventName = AuthorizeSecurityGroupIngress) || ($.eventName = AuthorizeSecurityGroupEgress) || ($.eventName = RevokeSecurityGroupIngress) || ($.eventName = RevokeSecurityGroupEgress) || ($.eventName = CreateSecurityGroup) || ($.eventName = DeleteSecurityGroup)}"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "securitygroupchanges",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors security group changes",
                            "alarm_name": "securitygroupchanges",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "securitygroupchanges",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "SecurityGroupChanges",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "unuatorhized-api-calls"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "unuatorhized-api-calls"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "unuatorhized-api-calls"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "unuatorhized-api-calls",
                        "attributes": {
                            "id": "unuatorhized-api-calls",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "UnauthorizedAPICalls",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "unuatorhized-api-calls",
                            "pattern": "{ ($.errorCode = \"*UnauthorizedOperation\") || ($.errorCode = \"AccessDenied*\") }"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "unuatorhized-api-calls",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors unauthorized API calls",
                            "alarm_name": "unuatorhized-api-calls",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "unuatorhized-api-calls",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "UnauthorizedAPICalls",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "vpcchanges"
            ],
            "outputs": {
                "alarm_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "vpcchanges"
                },
                "filter_id": {
                    "sensitive": false,
                    "type": "string",
                    "value": "vpcchanges"
                }
            },
            "resources": {
                "aws_cloudwatch_log_metric_filter.metric_filter": {
                    "type": "aws_cloudwatch_log_metric_filter",
                    "depends_on": [],
                    "primary": {
                        "id": "vpcchanges",
                        "attributes": {
                            "id": "vpcchanges",
                            "log_group_name": "CloudTrail/DefaultLogGroup",
                            "metric_transformation.#": "1",
                            "metric_transformation.0.name": "VPCChanges",
                            "metric_transformation.0.namespace": "CIS3XMetrics",
                            "metric_transformation.0.value": "1",
                            "name": "vpcchanges",
                            "pattern": "{ ($.eventName = CreateVpc) || ($.eventName = DeleteVpc) || ($.eventName = ModifyVpcAttribute) || ($.eventName = AcceptVpcPeeringConnection) || ($.eventName = CreateVpcPeeringConnection) || ($.eventName = DeleteVpcPeeringConnection) || ($.eventName = RejectVpcPeeringConnection) || ($.eventName = AttachClassicLinkVpc) || ($.eventName = DetachClassicLinkVpc) || ($.eventName = DisableVpcClassicLink) || ($.eventName = EnableVpcClassicLink) }"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_cloudwatch_metric_alarm.metric_alarm": {
                    "type": "aws_cloudwatch_metric_alarm",
                    "depends_on": [
                        "aws_cloudwatch_log_metric_filter.metric_filter"
                    ],
                    "primary": {
                        "id": "vpcchanges",
                        "attributes": {
                            "actions_enabled": "true",
                            "alarm_actions.#": "1",
                            "alarm_actions.713440792": "arn:aws:sns:eu-west-1:243740175260:cw-alert-topic",
                            "alarm_description": "This metric monitors vpc changes",
                            "alarm_name": "vpcchanges",
                            "comparison_operator": "GreaterThanOrEqualToThreshold",
                            "dimensions.%": "0",
                            "evaluate_low_sample_count_percentiles": "",
                            "evaluation_periods": "1",
                            "extended_statistic": "",
                            "id": "vpcchanges",
                            "insufficient_data_actions.#": "0",
                            "metric_name": "VPCChanges",
                            "namespace": "CIS3XMetrics",
                            "ok_actions.#": "0",
                            "period": "120",
                            "statistic": "Sum",
                            "threshold": "1",
                            "treat_missing_data": "notBreaching",
                            "unit": ""
                        },
                        "meta": {
                            "schema_version": "1"
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        }
    ]
}
